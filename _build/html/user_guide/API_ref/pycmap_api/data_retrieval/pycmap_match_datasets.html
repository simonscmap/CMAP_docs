


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>Match (colocalize) Datasets &mdash; CMAP</title>
    


  
  
    <link rel="shortcut icon" href="../../../../_static/CMAP_logo.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Match (colocalize) Cruise Track with Datasets" href="pycmap_match_cruise_track_datasets.html" />
    <link rel="prev" title="Data Subset: Depth Profile" href="pycmap_subset_DP.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Simons CMAP
          

          
            
            <img src="../../../../_static/CMAP_logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../catalog/catalog.html">Data Catalog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api_ref.html">Software Packages</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../pycmap_api_ref.html">pycmap API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../pycmap_install.html">Installation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../pycmap_data_retrieval.html">Data Retrieval</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pycmap_api.html">API</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_query.html">Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_catalog.html">Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_search_catalog.html">Search Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_dataset.html">Datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_metadata.html">Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_dataset_metadata.html">Dataset Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_dataset_columns.html">Dataset Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_dataset_head.html">Dataset Head</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_variable_long_name.html">Variable Long Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_variable_unit.html">Variable Unit</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_variable_resolution.html">Variable Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_var_coverage.html">Variable Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_var_stat.html">Variable Stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_has_field.html">If Column Exists</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_is_gridded.html">Is Gridded Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_is_climatology.html">Is Climatology Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_list_cruises.html">List of Cruises</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_cruise_details.html">Cruise Details by Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_cruise_ST_bounds.html">Cruise Spatio-Temporal Bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_cruise_trajectory.html">Cruise Trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_cruise_variables.html">Cruise Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_retrieve_dataset.html">Retrieve Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_subset_ST.html">Data Subset: Generic Space-Time Cut</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_subset_TS.html">Data Subset: Time Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_subset_DP.html">Data Subset: Depth Profile</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Match (colocalize) Datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycmap_match_cruise_track_datasets.html">Match (colocalize) Cruise Track with Datasets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pycmap_data_vizualization.html">Data Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pycmap_presentations.html">Presentations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cmap4r_api/cmap4r_api.html">cmap4r API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matcmap_api/matcmap_api_ref.html">matcmap API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../juliacmap_api/juliacmap_api_ref.html">juliacmap API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opedia_tutorials/opedia_tutorials.html">opedia (depreciated)</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">FAQ and Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq_and_contributing/datasubmission.html">Data Submission</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq_and_contributing/FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq_and_contributing/contact.html">Contact and Contribute</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Outside Resources
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://simonscmap.com/"><i class="fa fa-globe fa-fw"></i> Simons CMAP Web Application</a></li>
            
                <li class="toctree-l1"><a href="https://simonscmap.com/catalog"><i class="fa fa-archive fa-fw"></i> Interactive Data Catalog</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/simonscmap"><i class="fa fa-github fa-fw"></i> Project Source Code</a></li>
            
                <li class="toctree-l1"><a href="https://join.slack.com/t/simons-cmap/shared_invite/enQtNjQzMTkzMjg0NjQ2LTdlOGRhZjNhMDY3MjRlNjg2OTY5NzE3ZWZhNWE0OWZhYmQzMTJjNDkyNDQ1MjNkZDg0N2MzMzhlZDliNGYxYzQ"><i class="fa fa-slack fa-fw"></i> Slack</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Simons CMAP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../api_ref.html">Software Packages</a> &raquo;</li>
        
          <li><a href="../pycmap_api_ref.html">pycmap API</a> &raquo;</li>
        
          <li><a href="../pycmap_data_retrieval.html">Data Retrieval</a> &raquo;</li>
        
      <li>Match (colocalize) Datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="match-colocalize-datasets">
<span id="match"></span><h1>Match (colocalize) Datasets<a class="headerlink" href="#match-colocalize-datasets" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://colab.research.google.com/github/simonscmap/pycmap/blob/master/docs/Match.ipynb"><img alt="https://colab.research.google.com/assets/colab-badge.svg" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/simonscmap/pycmap/master?filepath=docs%2FMatch.ipynb"><img alt="https://mybinder.org/badge_logo.svg" src="https://mybinder.org/badge_logo.svg" /></a>
<dl class="method">
<dt>
<code class="sig-name descname">match</code><span class="sig-paren">(</span><em class="sig-param">sourceTable</em>, <em class="sig-param">sourceVar</em>, <em class="sig-param">targetTables</em>, <em class="sig-param">targetVars</em>, <em class="sig-param">dt1</em>, <em class="sig-param">dt2</em>, <em class="sig-param">lat1</em>, <em class="sig-param">lat2</em>, <em class="sig-param">lon1</em>, <em class="sig-param">lon2</em>, <em class="sig-param">depth1</em>, <em class="sig-param">depth2</em>, <em class="sig-param">temporalTolerance</em>, <em class="sig-param">latTolerance</em>, <em class="sig-param">lonTolerance</em>, <em class="sig-param">depthTolerance</em><span class="sig-paren">)</span></dt>
<dd><p>Colocalizes the source variable (from source table) with the target variable (from target table). The matching results rely on the tolerance parameters because they set the matching boundaries between the source and target datasets. Notice the source has to be a single non-climatological variable. You may pass empty string (‘’) as source variable if you only want to get the time and location info from the source table. Please note that the number of matching entries between each target variable and the source variable might vary depending on the temporal and spatial resolutions of the target variable. In principle, if the source dataset is fully covered by the target variable’s spatio-temporal range, there should always be matching results if the tolerance parameters are larger than half of their corresponding spatial/temporal resolutions. Please explore the <a class="reference internal" href="../../../../catalog/catalog.html#catalog"><span class="std std-ref">Data Catalog</span></a> to find appropriate target variables.</p>
<p>This method returns a dataframe containing the source variable joined with the target variable(s).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, the ‘match’ method is not optimized for matching very large subsets of massive datasets such as models and satellites. It would be best to use this method to colocalize in-situ measurements such as station-based or underway cruise datasets (which are typically ‘small’) with any other datasets (models, satellites, or other observations).</p>
<p>Stay tuned!</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sourceTable: string</strong></dt><dd><p>Table name of the source dataset. A full list of table names can be found in the <a class="reference internal" href="../../../../catalog/catalog.html#catalog"><span class="std std-ref">Data Catalog</span></a>.</p>
</dd>
<dt><strong>sourceVar: string</strong></dt><dd><p>The source variable short name. The target variables are matched (colocalized) with this variable. A full list of variable short names can be found in the <a class="reference internal" href="../../../../catalog/catalog.html#catalog"><span class="std std-ref">Data Catalog</span></a>.</p>
</dd>
<dt><strong>targetTables: list of string</strong></dt><dd><p>Table names of the target datasets to be matched with the source data. Note source dataset can be matched with multiple target datasets. A full list of table names can be found in the <a class="reference internal" href="../../../../catalog/catalog.html#catalog"><span class="std std-ref">Data Catalog</span></a>.</p>
</dd>
<dt><strong>targetVars: list of string</strong></dt><dd><p>Variable short names to be matched with the source variable. A full list of variable short names can be found in the <a class="reference internal" href="../../../../catalog/catalog.html#catalog"><span class="std std-ref">Data Catalog</span></a>.</p>
</dd>
<dt><strong>dt1: string</strong></dt><dd><p>Start date or datetime. This parameter sets the lower bound of the temporal cut.
Example values: ‘2016-05-25’ or ‘2017-12-10 17:25:00’.</p>
</dd>
<dt><strong>dt2: string</strong></dt><dd><p>End date or datetime. This parameter sets the upper bound of the temporal cut. Example values: ‘2016-05-25’ or ‘2017-12-10 17:25:00’.</p>
</dd>
<dt><strong>lat1: float</strong></dt><dd><p>Start latitude [degree N]. This parameter sets the lower bound of the meridional cut. Note latitude ranges from -90° to 90°.</p>
</dd>
<dt><strong>lat2: float</strong></dt><dd><p>End latitude [degree N]. This parameter sets the upper bound of the meridional cut. Note latitude ranges from -90° to 90°.</p>
</dd>
<dt><strong>lon1: float</strong></dt><dd><p>Start longitude [degree E]. This parameter sets the lower bound of the zonal cut. Note longitude ranges from -180° to 180°.</p>
</dd>
<dt><strong>lon2: float</strong></dt><dd><p>End longitude [degree E]. This parameter sets the upper bound of the zonal cut. Note longitude ranges from -180° to 180°.</p>
</dd>
<dt><strong>depth1: float</strong></dt><dd><p>Start depth [m]. This parameter sets the lower bound of the vertical cut. Note depth is a positive number (it is 0 at the surface and increases towards the ocean floor).</p>
</dd>
<dt><strong>depth2: float</strong></dt><dd><p>End depth [m]. This parameter sets the upper bound of the vertical cut. Note depth is a positive number (it is 0 at the surface and increases towards the ocean floor).</p>
</dd>
<dt><strong>temporalTolerance: list of int</strong></dt><dd><p>Temporal tolerance values between pairs of source and target datasets. The size and order of values in this list should match those of targetTables. If only a single integer value is given, that would be applied to all target datasets. This parameter is in days except when the target variable represents monthly climatology data in which case it is in months. Notice fractional values are not supported in the current version.</p>
</dd>
<dt><strong>latTolerance: list of float or int</strong></dt><dd><p>Spatial tolerance values in meridional direction [deg] between pairs of source and target datasets. The size and order of values in this list should match those of targetTables. If only a single float value is given, that would be applied to all target datasets. A “safe” value for this parameter can be slightly larger than the half of the target variable’s spatial resolution.</p>
</dd>
<dt><strong>lonTolerance: list of float or int</strong></dt><dd><p>Spatial tolerance values in zonal direction [deg] between pairs of source and target datasets. The size and order of values in this list should match those of targetTables. If only a single float value is given, that would be applied to all target datasets. A “safe” value for this parameter can be slightly larger than the half of the target variable’s spatial resolution.</p>
</dd>
<dt><strong>depthTolerance: list of float or int</strong></dt><dd><p>Spatial tolerance values in vertical direction [m] between pairs of source and target datasets. The size and order of values in this list should match those of targetTables. If only a single float value is given, that would be applied to all target datasets.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns:</dt>
<dd class="field-even"><p>Pandas dataframe.</p>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="example-1">
<h2>Example 1:<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<p>In this example, the abundance of a prochlorococcus strain (MIT9313PCR, see lines 5-6) measured by Chisholm lab during the AMT13 cruise (Atlantic Meridional Transect Cruise 13) is colocalized with 3 target variables (lines 7-8):</p>
<ul class="simple">
<li><p>‘MIT9312PCR_Chisholm’ from the same source dataset</p></li>
<li><p>‘phosphate*WOA*clim’ from World Ocean Atlas monthly climatology dataset</p></li>
<li><p>‘chl’ (chlorophyll) from weekly averaged satellite dataset</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Tip1:</strong></p>
<p>The space-time cut parameters (lines 9-16) have been set in such a way to encompass the entire source dataset ‘tblAMT13_Chisholm’ (see the dataset page for more details). Note that the last data point at the source dataset has been measured at ‘2003-10-12 12:44:00’. For simplicity dt2 has been set to ‘2003-10-13’, but you could also use the exact date-time ‘2003-10-12 12:44:00’.</p>
<p><strong>Tip2:</strong></p>
<p>AMT13 cruise trajectory is already in Simons CMAP database. Therefore, another way to find reasonable values for the space-time cut parameters (lines 9-16) is to use the outputs of the following command:
api.cruise_bounds(‘AMT13’).</p>
<p><strong>Tip3:</strong></p>
<p>The temporalTolerance parameter is set to [0, 0, 1] (line 17). This means:</p>
<ul class="simple">
<li><p>±0 day temporal tolerance when matching with ‘MIT9312PCR_Chisholm’ (exact date-time matching)</p></li>
<li><p>±0 month temporal tolerance when matching with ‘phosphate*WOA*clim’ (this is a monthly climatology dataset)</p></li>
<li><p>±4 day temporal tolerance when matching with ‘chl’ (this is a weekly averaged dataset)</p></li>
</ul>
<p><strong>Tip4:</strong></p>
<p>The latTolerance and lonTolerance parameters are set to [0, 0.5, 0.25] (lines 18-19). This means:</p>
<ul class="simple">
<li><p>±0 day temporal tolerance when matching with ‘MIT9312PCR_Chisholm’ (exact date-time matching)</p></li>
<li><p>±0 month temporal tolerance when matching with ‘phosphate*WOA*clim’ (this is a monthly climatology dataset)</p></li>
<li><p>±4 day temporal tolerance when matching with ‘chl’ (this is a weekly averaged dataset)</p></li>
</ul>
<p><strong>Tip5:</strong></p>
<p>The depthTolerance parameter is set to [0, 5, 0] (line 20). This means:</p>
<ul class="simple">
<li><p>±0 meters vertical tolerances when matching with ‘MIT9312PCR_Chisholm’ (exact depth matching).</p></li>
<li><p>±5 meters vertical tolerances when matching with ‘phosphate*WOA*clim’ (note that this dataset, similar to model outputs, does not have uniform depth levels).</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install pycmap -q     #uncomment to install pycmap, if necessary</span>

<span class="kn">import</span> <span class="nn">pycmap</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">pycmap</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;&lt;YOUR_API_KEY&gt;&#39;</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
         <span class="n">sourceTable</span><span class="o">=</span><span class="s1">&#39;tblAMT13_Chisholm&#39;</span><span class="p">,</span>
         <span class="n">sourceVar</span><span class="o">=</span><span class="s1">&#39;MIT9313PCR_Chisholm&#39;</span><span class="p">,</span>
         <span class="n">targetTables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tblAMT13_Chisholm&#39;</span><span class="p">,</span> <span class="s1">&#39;tblWOA_Climatology&#39;</span><span class="p">,</span> <span class="s1">&#39;tblChl_REP&#39;</span><span class="p">],</span>
         <span class="n">targetVars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MIT9312PCR_Chisholm&#39;</span><span class="p">,</span> <span class="s1">&#39;phosphate_WOA_clim&#39;</span><span class="p">,</span> <span class="s1">&#39;chl&#39;</span><span class="p">],</span>
         <span class="n">dt1</span><span class="o">=</span><span class="s1">&#39;2003-09-14&#39;</span><span class="p">,</span>
         <span class="n">dt2</span><span class="o">=</span><span class="s1">&#39;2003-10-13&#39;</span><span class="p">,</span>
         <span class="n">lat1</span><span class="o">=-</span><span class="mi">48</span><span class="p">,</span>
         <span class="n">lat2</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
         <span class="n">lon1</span><span class="o">=-</span><span class="mi">52</span><span class="p">,</span>
         <span class="n">lon2</span><span class="o">=-</span><span class="mi">11</span><span class="p">,</span>
         <span class="n">depth1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
         <span class="n">depth2</span><span class="o">=</span><span class="mi">240</span><span class="p">,</span>
         <span class="n">temporalTolerance</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
         <span class="n">latTolerance</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
         <span class="n">lonTolerance</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
         <span class="n">depthTolerance</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2">
<h2>Example 2:<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<p>The source variable in this example is particulate pseudo cobalamin (‘Me_PseudoCobalamin_Particulate_pM’ see lines 5-6) measured by Ingalls lab during the KM1315 cruise. This variable is colocalized with one target variabele, ‘picoprokaryote’ concentration, from Darwin model (lines 7-8). The colocalized data, then is visualized. please review the above Example 1, since the mentioned tips apply to this example too.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Tip1:</strong></p>
<p>The employed Darwin model outputs are a 3-day averaged dataset, and therefore ±2 day temporal tolerance is used (line 17).</p>
<p><strong>Tip2:</strong></p>
<p>The employed Darwin model outputs have has a 0.5 degree spatial resolution in zonal and meridional directions, and so ±0.25 degree spatial tolerance is used (line 18-19).</p>
<p><strong>Tip3:</strong></p>
<p>Darwin model first depth level is at 5 m (not 0), and so ±5 meter vertical tolerance should cover all surface measurements (line 20).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># !pip install pycmap -q     # uncomment to install pycmap, if necessary</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pycmap</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">pycmap</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;&lt;YOUR_API_KEY&gt;&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
              <span class="n">sourceTable</span><span class="o">=</span><span class="s1">&#39;tblKM1314_Cobalmins&#39;</span><span class="p">,</span>
              <span class="n">sourceVar</span><span class="o">=</span><span class="s1">&#39;Me_PseudoCobalamin_Particulate_pM&#39;</span><span class="p">,</span>
              <span class="n">targetTables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tblDarwin_Phytoplankton&#39;</span><span class="p">],</span>
              <span class="n">targetVars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;picoprokaryote&#39;</span><span class="p">],</span>
              <span class="n">dt1</span><span class="o">=</span><span class="s1">&#39;2013-08-11&#39;</span><span class="p">,</span>
              <span class="n">dt2</span><span class="o">=</span><span class="s1">&#39;2013-09-05&#39;</span><span class="p">,</span>
              <span class="n">lat1</span><span class="o">=</span><span class="mf">22.5</span><span class="p">,</span>
              <span class="n">lat2</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
              <span class="n">lon1</span><span class="o">=-</span><span class="mi">159</span><span class="p">,</span>
              <span class="n">lon2</span><span class="o">=-</span><span class="mi">128</span><span class="p">,</span>
              <span class="n">depth1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">depth2</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
              <span class="n">temporalTolerance</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
              <span class="n">latTolerance</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">],</span>
              <span class="n">lonTolerance</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">],</span>
              <span class="n">depthTolerance</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
              <span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;picoprokaryote&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Me_PseudoCobalamin_Particulate_pM&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;picoprokaryote&#39;</span> <span class="o">+</span> <span class="n">api</span><span class="o">.</span><span class="n">get_unit</span><span class="p">(</span><span class="s1">&#39;tblDarwin_Phytoplankton&#39;</span><span class="p">,</span> <span class="s1">&#39;picoprokaryote&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Me_PseudoCobalamin_Particulate_pM&#39;</span> <span class="o">+</span> <span class="n">api</span><span class="o">.</span><span class="n">get_unit</span><span class="p">(</span><span class="s1">&#39;tblKM1314_Cobalmins&#39;</span><span class="p">,</span> <span class="s1">&#39;Me_PseudoCobalamin_Particulate_pM&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../../../../_images/sql.png" src="../../../../_images/sql.png" style="width: 51.2px; height: 51.2px;" />
</div>
<p><strong>SQL Statement</strong></p>
<p>Here is how to achieve the same results using a direct SQL statement. Please refer to <a class="reference internal" href="pycmap_query.html#query"><span class="std std-ref">Query</span></a> for more information.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="n">uspMatch</span>
 <span class="s1">&#39;sourceTable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sourceVariable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;targetTable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;targetVariable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dt1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dt2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lat1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lat2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lon1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lon2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depth1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depth2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;timeTolerance&#39;</span><span class="p">,</span>
 <span class="s1">&#39;latTolerance&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lonTolerance&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depthTolerance&#39;</span>
</pre></div>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="n">uspMatch</span>
 <span class="s1">&#39;tblKM1314_Cobalmins&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Me_PseudoCobalamin_Particulate_pM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tblDarwin_Phytoplankton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;picoprokaryote&#39;</span><span class="p">,</span>
 <span class="s1">&#39;2013-08-09 00:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;2013-09-07 00:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;22.25&#39;</span><span class="p">,</span>
 <span class="s1">&#39;50.25&#39;</span><span class="p">,</span>
 <span class="s1">&#39;-159.25&#39;</span><span class="p">,</span>
 <span class="s1">&#39;-127.75&#39;</span><span class="p">,</span>
 <span class="s1">&#39;-5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;305&#39;</span><span class="p">,</span>
 <span class="s1">&#39;2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;0.25&#39;</span><span class="p">,</span>
 <span class="s1">&#39;0.25&#39;</span><span class="p">,</span>
 <span class="s1">&#39;5&#39;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 
      <span class="lastupdated">
        Last updated on Apr 28, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>